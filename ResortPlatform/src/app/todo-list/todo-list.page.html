<ion-menu type="overlay" content-id="main-content" *ngIf="fdUser">
  <ion-content class="ion-padding">
    <ion-menu-toggle  >
          <ion-button *ngFor="let department of fdUser.departments"
            style="width: 100%; cursor: pointer"
            (click)="onDepartmetnChange(department)"
            class="btn-icon-only"
          [ngClass]="{'selected-btn': selectedDepartment === department}">{{department}}</ion-button>
    </ion-menu-toggle>
  </ion-content>
</ion-menu>
<div class="ion-page" id="main-content">
<ion-content [fullscreen]="true">
  <ion-grid >
  <ion-row style="width: 100%" class="ion-justify-content-center ion-align-items-center">
    <ion-col size-xs="2"  size-sm="2" size="1">
      <ion-menu-toggle>
        <ion-button
          size="large"
          class="btn-icon-only">
          <ion-icon name="menu-outline"></ion-icon>
        </ion-button>
      </ion-menu-toggle>
    </ion-col>
    <ion-col size-xs="8"  size-sm="8" size="10">
      <ion-text class="ion-justify-content-center ion-text-center" color="primary" >
        <h2 style="font-weight: bold; font-family: 'baskerville';width: 100%; ">{{selectedDepartment}}</h2>
      </ion-text>
    </ion-col>
    <ion-col size-xs="2" size-sm="2" size="1" class="ion-justify-content-center ion-text-center ion-align-items-center">

        <ion-button

          *ngIf="maxDate && selectedDate"
          (click)="showCalendar = true"
          expand="block"
          class="btn-icon-only"><ion-icon name="calendar-outline"></ion-icon>
        </ion-button>
    </ion-col>
  </ion-row>
  <ion-row class="ion-no-padding ion-no-margin">
      <ion-col class="ion-text-center ion-no-margin ion-no-padding">
        <ion-text  class="ion-no-padding ion-no-margin">
          <h3 *ngIf="selectedDate"  class="ion-no-padding ion-no-margin">{{selectedDate | date: "EEEE, dd.MM.yyyy"}}</h3>
        </ion-text>
      </ion-col>
  </ion-row>

  <ion-row *ngIf="myTaskLists">
    <ion-col>
      <ion-segment  [(ngModel)]="selectedList" color="primary" value="today" style="width: 100%">
        <ion-segment-button value="today">
          <ion-label>Today's Tasks</ion-label>
        </ion-segment-button>
        <ion-segment-button value="mine">
          <ion-label>My Tasks</ion-label>
        </ion-segment-button>
      </ion-segment>
    </ion-col>
  </ion-row>
    <ion-row *ngIf="taskLoading" class="ion-justify-content-center ion-align-items-center">
      <div class="ion-justify-content-center">
        <ion-item lines="none">
          <ion-spinner color="primary" style="width: 5rem; height: 5rem"></ion-spinner>
        </ion-item>
      </div>
    </ion-row>
  <ion-row  *ngIf="!taskLoading">
    <ion-infinite-scroll>

        <ion-col>
          <ion-accordion-group   *ngIf="selectedList === 'today'" [multiple]="true">
            <ion-accordion *ngFor="let tasks of taskListsAll; let i = index" >
              <ion-item slot="header" lines="none" class="gradient-accordion ion-text-wrap ion-text-start">
                <ion-label class="ion-text-wrap ion-text-start">{{tasks.title}}</ion-label>
              </ion-item>
              <div class="ion-padding" slot="content" style="padding-top: 0">
                <ion-card *ngFor="let tk of taskListsAll[i].tasks" style="width: 100%; margin-left: 0; border-radius: 15px; padding-left: 0">
                  <ion-card-title class="ion-padding" >
                    <ion-row>
                      <ion-col size="10">
                        {{tk.title}}
                        <ion-text>
                          <h6 *ngIf="tk.assignee">{{tk.assignee.name}} {{tk.assignee.surname}}</h6>
                          <h6 *ngIf="!tk.assignee">No Assignee</h6>
                        </ion-text></ion-col>
                      <ion-col size="2">
                        <ion-checkbox
                          labelPlacement="start"
                          class="ion-margin"
                          alignment="end"
                          [disabled]="disableTask()"
                          [(ngModel)]="tk.completed"
                          [class]="tk.completed ? 'item-done' : ''"
                          (ionChange)="toggleDone(tk, tasks, i)"
                        >
                        </ion-checkbox
                        >

                      </ion-col>
                    </ion-row>
                  </ion-card-title>
                </ion-card>
              </div>
            </ion-accordion>
          </ion-accordion-group>

          <ion-accordion-group  *ngIf="selectedList === 'mine'" [multiple]="true">
            <ion-accordion *ngFor="let tasks of myTaskLists; let i = index" >
              <ion-item slot="header" lines="none" class="gradient-accordion ion-text-wrap">
                <ion-label  class="ion-text-wrap">{{tasks.title}}</ion-label>
              </ion-item>

              <div class="ion-padding" slot="content">
                <ion-infinite-scroll>
                  <ion-infinite-scroll-content>
                    <ion-card *ngFor="let tk of myTaskLists[i].tasks" style="width: 100%; margin-left: 0; border-radius: 15px; padding-left: 0">
                      <ion-card-title class="ion-padding" style="padding-bottom: 0; padding-left: 0">
                        <ion-row>
                          <ion-col size="10">
                            {{tk.title}}
                            <ion-text>
                              <h6 *ngIf="tk.assignee">{{tk.assignee.name}} {{tk.assignee.surname}}</h6>
                              <h6 *ngIf="!tk.assignee">No Assignee</h6>
                            </ion-text></ion-col>
                          <ion-col size="2">
                            <ion-checkbox
                              labelPlacement="start"
                              class="ion-margin"
                              alignment="end"
                              [disabled]="disableTask()"
                              [(ngModel)]="tk.completed"
                              [class]="tk.completed ? 'item-done' : ''"
                              (ionChange)="toggleDone(tk, tasks, i)"
                            >
                            </ion-checkbox
                            >
                          </ion-col>
                        </ion-row>
                      </ion-card-title>
                    </ion-card>
                  </ion-infinite-scroll-content>
                </ion-infinite-scroll>
              </div>
            </ion-accordion>
          </ion-accordion-group>
        </ion-col>
    </ion-infinite-scroll>
  </ion-row>
  </ion-grid>
<!--  <div class="flexContainer">-->
<!--    <ion-button (click)="changeDate(-1)">-->
<!--      <ion-icon name="chevron-back-outline"></ion-icon>-->
<!--    </ion-button>-->
<!--    <p>{{selectedDate | date : 'dd.MM.yyyy'}}</p>-->
<!--    <ion-button (click)="changeDate(1)" [disabled]="isButtonDisabled()">-->
<!--      <ion-icon name="chevron-forward-outline"></ion-icon>-->
<!--    </ion-button>-->
<!--  </div>-->

<!--  <p>{{dataStatusMsg}}</p>-->
<!--  <ion-accordion-group expand="inset">-->
<!--    <ion-accordion *ngFor="let taskList of taskLists; let i = index">-->
<!--      <ion-item slot="header" color="primary">-->
<!--        <ion-label>{{taskList.title}}</ion-label>-->
<!--        <ion-label slot="end"-->
<!--          >{{completedTasks[i]}}/{{taskList.tasks.length}}</ion-label-->
<!--        >-->
<!--      </ion-item>-->
<!--      <ion-item-->
<!--        slot="content"-->
<!--        color="light"-->
<!--        *ngFor="let task of taskList.tasks; let j = index"-->
<!--      >-->
<!--        <ion-checkbox-->
<!--          [(ngModel)]="task.completed"-->
<!--          [class]="task.completed ? 'item-done' : ''"-->
<!--          (ionChange)="toggleDone(task, taskList, i)"-->
<!--          >{{task.title}}</ion-checkbox-->
<!--        >-->
<!--      </ion-item>-->
<!--    </ion-accordion>-->
<!--  </ion-accordion-group>-->

  <!-- Scroll to Top Button -->
  <!-- <ion-button
    (click)="scrollToTop()"
    class="scroll-to-top-button"
    *ngIf="showScrollButton"
  >
    <ion-icon name="arrow-up"></ion-icon>
  </ion-button> -->
  <ion-datetime-button datetime="datetime" id="fake-click"></ion-datetime-button>
  <ion-modal class="example-modal" style="height: 100%" [keepContentsMounted]="true" [isOpen]="showCalendar" (didDismiss)="cancelCalendar()">
    <ng-template style="height: 100%">
        <ion-datetime style="height: 100%"
          [(ngModel)]="selectedDate"
          [max]="maxDate"
          id="datetime" [firstDayOfWeek]="1"
          presentation="date"
          [showDefaultButtons]="true"
          doneText="Confirm"
                      color="primary"
          cancelText="Cancel"
                      (ionChange)="updateTaskLists()"
                      #datetime
        ></ion-datetime>

    </ng-template>
  </ion-modal>
</ion-content>
</div>
